<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.bcs.web.apply.mapper.ApplyRecordMapper">
    <select id="selectCallFee" resultType="cn.bcs.web.apply.domain.vo.MonthCallFeeVO">
        select
            from_user_id as userId,
            sum(taocan_value) as amount,
            group_concat(id) as recordIds
        from b_apply_record
        where status = 1
        and end_time &lt; now()
        group by from_user_id
    </select>

    <select id="selectMaxApplyRecord" resultType="cn.bcs.web.apply.domain.ApplyRecord">
        SELECT
            from_user_id,
            MAX(create_time) AS create_time
        FROM b_apply_record
        WHERE status = '1'
        GROUP BY from_user_id;
    </select>
</mapper>